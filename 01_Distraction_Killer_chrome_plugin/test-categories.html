<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Category Test - Distraction Killer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-button:hover {
            background: #5a67d8;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>Distraction Killer - Category Test</h1>
    <p>This page helps you test if all blocking categories are working correctly.</p>

    <div class="test-section">
        <h2>Test Instructions</h2>
        <ol>
            <li>Open the Distraction Killer extension settings</li>
            <li>Disable a category (e.g., uncheck "Shopping & E-commerce")</li>
            <li>Start a focus session</li>
            <li>Click the test buttons below to try accessing blocked sites</li>
            <li>Verify that disabled categories are NOT blocked</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Category Tests</h2>
        
        <h3>Social Media (should be blocked when enabled)</h3>
        <button class="test-button" onclick="testSite('https://instagram.com')">Test Instagram</button>
        <button class="test-button" onclick="testSite('https://facebook.com')">Test Facebook</button>
        <button class="test-button" onclick="testSite('https://twitter.com')">Test Twitter</button>
        
        <h3>Shopping & E-commerce (should be blocked when enabled)</h3>
        <button class="test-button" onclick="testSite('https://amazon.com')">Test Amazon</button>
        <button class="test-button" onclick="testSite('https://flipkart.com')">Test Flipkart</button>
        <button class="test-button" onclick="testSite('https://ebay.com')">Test eBay</button>
        
        <h3>News & Media (should be blocked when enabled)</h3>
        <button class="test-button" onclick="testSite('https://cnn.com')">Test CNN</button>
        <button class="test-button" onclick="testSite('https://bbc.com')">Test BBC</button>
        <button class="test-button" onclick="testSite('https://nytimes.com')">Test NY Times</button>
        
        <h3>Entertainment (should be blocked when enabled)</h3>
        <button class="test-button" onclick="testSite('https://youtube.com')">Test YouTube</button>
        <button class="test-button" onclick="testSite('https://netflix.com')">Test Netflix</button>
        <button class="test-button" onclick="testSite('https://spotify.com')">Test Spotify</button>
        
        <h3>Adult Content (should be blocked when enabled)</h3>
        <button class="test-button" onclick="testSite('https://pornhub.com')">Test PornHub</button>
        <button class="test-button" onclick="testSite('https://xvideos.com')">Test XVideos</button>
    </div>

    <div class="test-section">
        <h2>Test Results</h2>
        <div id="results"></div>
    </div>

    <div class="test-section">
        <h2>Debug Information</h2>
        <button class="test-button" onclick="checkSettings()">Check Current Settings</button>
        <button class="test-button" onclick="checkSession()">Check Session Status</button>
        <div id="debug"></div>
    </div>

    <script>
        function testSite(url) {
            const resultDiv = document.getElementById('results');
            const testResult = document.createElement('div');
            testResult.className = 'result info';
            testResult.innerHTML = `Testing: ${url} - <a href="${url}" target="_blank">Click to test</a>`;
            resultDiv.appendChild(testResult);
        }

        async function checkSettings() {
            try {
                const result = await chrome.storage.local.get(['userSettings']);
                const settings = result.userSettings;
                const debugDiv = document.getElementById('debug');
                
                let html = '<h3>Current Settings:</h3>';
                if (settings && settings.siteCategories) {
                    html += '<ul>';
                    Object.keys(settings.siteCategories).forEach(category => {
                        const enabled = settings.siteCategories[category];
                        html += `<li><strong>${category}:</strong> ${enabled ? '✅ Enabled' : '❌ Disabled'}</li>`;
                    });
                    html += '</ul>';
                } else {
                    html += '<p>No settings found</p>';
                }
                
                debugDiv.innerHTML = html;
            } catch (error) {
                document.getElementById('debug').innerHTML = '<div class="result error">Error checking settings: ' + error.message + '</div>';
            }
        }

        async function checkSession() {
            try {
                const result = await chrome.storage.local.get(['currentSession']);
                const session = result.currentSession;
                const debugDiv = document.getElementById('debug');
                
                let html = '<h3>Current Session:</h3>';
                if (session) {
                    html += `<p><strong>Active:</strong> ${session.isActive ? '✅ Yes' : '❌ No'}</p>`;
                    html += `<p><strong>Session ID:</strong> ${session.id || 'N/A'}</p>`;
                    html += `<p><strong>Duration:</strong> ${session.duration || 'N/A'} minutes</p>`;
                } else {
                    html += '<p>No active session</p>';
                }
                
                debugDiv.innerHTML = html;
            } catch (error) {
                document.getElementById('debug').innerHTML = '<div class="result error">Error checking session: ' + error.message + '</div>';
            }
        }

        // Auto-check settings on page load
        window.addEventListener('load', () => {
            checkSettings();
            checkSession();
        });
    </script>
</body>
</html>
